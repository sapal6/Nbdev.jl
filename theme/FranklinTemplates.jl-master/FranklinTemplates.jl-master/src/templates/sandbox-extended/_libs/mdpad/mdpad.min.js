mdpad=function(){var use_url=true;var replace_url=false;var variable_defaults={};function enable_url(){use_url=true}function disable_url(){use_url=false}function enable_replace_url(){replace_url=true}function disable_replace_url(){replace_url=false}function ready(fn){if(document.readyState!="loading"){fn()}else{document.addEventListener("DOMContentLoaded",fn)}}ready(function(){Promise.resolve().then(init).then(update_forms).then(calculate).then(setup_listeners)});function init(){if("mdpad_init"in window)mdpad_init();calculate_forms();variable_defaults=Object.assign({},mdpad)}function update_forms(){if(use_url){var url=new URL(window.location);var params=new URLSearchParams(url.search);Object.keys(variable_defaults).forEach(function(key){var el=document.querySelector("[mdpad="+key+"]");if(el)set_element_value(el,variable_defaults[key])});url.searchParams.forEach(function(value,key){var el=document.querySelector("[mdpad="+key+"]");if(el)set_element_value(el,value)})}}function setup_listeners(){if(!("mdpad_update"in window))return;document.addEventListener("keyup",function(event){if(event.target.matches("input, textarea, datalist, button")&&event.target.getAttribute("mdpad")&&event.key=="Enter"){update_element(event.target);calculate()}},false);document.addEventListener("change",function(event){if(event.target.matches("select, input, textarea, datalist")&&event.target.getAttribute("mdpad")){update_element(event.target);calculate()}},false);window.addEventListener("popstate",function(event){update_forms();calculate()},true)}function update_element(el){name=el.getAttribute("mdpad");if(name&&use_url){var url=new URL(window.location);var params=new URLSearchParams(url.search);params.set(name,element_value(el));if(replace_url){window.history.replaceState({},"",`${location.pathname}?${params}`)}else{window.history.pushState({},"",`${location.pathname}?${params}`)}}}function set_element_value(el,value){if(el.type=="checkbox"){el.checked=value}else if(el.type=="radio"){document.querySelectorAll("[mdpad="+el.getAttribute("mdpad")+"]").forEach(el=>{el.checked=el.value==value})}else{el.value=value}}function element_value(x){if(x.type=="text"){return x.value}else if(x.type=="number"){return Number(x.value)}else if(x.type=="radio"&&x.checked){return x.value}else if(x.type=="checkbox"){return x.checked}else if(x.nodeName.toLowerCase()=="select"){return x[x.selectedIndex].value}else if(x.nodeName.toLowerCase()=="textarea"){return x.value}return undefined}function read_form(x,i,a){var name=x.getAttribute("mdpad");var val=element_value(x);if(name&&typeof val!=="undefined")mdpad[name]=val}function calculate_forms(){document.querySelectorAll("input, select, textarea, datalist").forEach(read_form)}function calculate(){calculate_forms();if("mdpad_update"in window)mdpad_update()}return{api:{calculate:calculate,enable_url:enable_url,disable_url:disable_url,enable_replace_url:enable_replace_url,disable_replace_url:disable_replace_url}}}();
